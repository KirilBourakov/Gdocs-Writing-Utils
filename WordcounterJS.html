<script>

  document.addEventListener('DOMContentLoaded', function() {
      
      google.script.run.withSuccessHandler((words) => {
        const body = document.getElementById("body")

        // table
        const table = document.createElement("table")
        table.classList.add("table");
        body.appendChild(table)

      
        const tbody = document.createElement("tbody")
        table.appendChild(genericTableHeadMaker(['Word', 'Number'], [], 'col'))
        table.appendChild(tbody)


        sorted = Object.keys(words).sort(function(a,b){return words[b]-words[a]})
        total = 0
        for (var word of sorted) {
          total += words[word]
          tbody.appendChild(genericTableRowMaker(word, [words[word]], "row", `wordcounter-${word}`))
        }
        console.log(total)
      }).CountUniqueWords()
  }, false);
</script>
